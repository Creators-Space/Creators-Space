<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 2rem; border-radius: 10px; }
        .button { background: #5a73e5; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .result { margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 5px; white-space: pre-wrap; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        input, select { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px; }
        label { font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Signup Process Test</h1>
        
        <button class="button" onclick="testDatabase()">Test Database</button>
        <div id="db-result" class="result" style="display: none;"></div>
        
        <h3>Test Signup</h3>
        <form id="test-form">
            <label>First Name:</label>
            <input type="text" name="first_name" value="John" required>
            
            <label>Last Name:</label>
            <input type="text" name="last_name" value="Doe">
            
            <label>Email:</label>
            <input type="email" name="email" value="john.doe.test@test.com" required>
            
            <label>Username:</label>
            <input type="text" name="username" value="johndoe123">
            
            <label>Password:</label>
            <input type="password" name="password" value="Test123!" required>
            
            <label>Confirm Password:</label>
            <input type="password" name="confirm_password" value="Test123!" required>
            
            <input type="checkbox" name="terms" checked required> I agree to terms
            
            <button type="submit" class="button">Test Signup</button>
        </form>
        
        <div id="signup-result" class="result" style="display: none;"></div>
    </div>

    <script>
        function showResult(elementId, content, isSuccess = true) {
            const element = document.getElementById(elementId);
            element.innerHTML = content;
            element.className = `result ${isSuccess ? 'success' : 'error'}`;
            element.style.display = 'block';
        }

        function testDatabase() {
            fetch('../backend/auth/test_db.php')
                .then(response => response.text())
                .then(text => {
                    showResult('db-result', text, true);
                })
                .catch(error => {
                    showResult('db-result', 'Database test failed: ' + error.message, false);
                });
        }

        document.getElementById('test-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            console.log('Testing signup with data:', Object.fromEntries(formData));
            
            fetch('../backend/auth/signup_process.php', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log('Response status:', response.status);
                return response.text();
            })
            .then(text => {
                console.log('Raw response:', text);
                try {
                    const data = JSON.parse(text);
                    showResult('signup-result', `
Status: ${data.success ? 'SUCCESS' : 'FAILED'}
Message: ${data.message}

Raw Response:
${text}
                    `, data.success);
                } catch (e) {
                    showResult('signup-result', `
JSON Parse Error: ${e.message}

Raw Response:
${text}
                    `, false);
                }
            })
            .catch(error => {
                showResult('signup-result', 'Network error: ' + error.message, false);
            });
        });
        
        // Auto-test database on load
        window.onload = () => testDatabase();
    </script>
</body>
</html>